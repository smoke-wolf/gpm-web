
<!DOCTYPE html>
<html>
<head>
<style>
  .gray-button {
    background-color: #808080; /* Gray color */
    color: white; /* Text color */
    padding: 10px 20px;
    border: none;
    border-radius: 100px;
    cursor: pointer;
    font-size: 16px;
    margin-left: 10px;
  }

  .hidden {
    display: none;
  }

  .spearmint-background {
    background-color: #64b890; /* Hexadecimal value for spearmint green */
    width: 100%;
    height: 100vh;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
  }
</style>
<link rel="stylesheet" type="text/css" href="install.css">
<script src="install.js"></script>
<script>
    $(document).ready(function() {
  $("#showLoginForm").click(function() {
    $("#loginForm").toggleClass("hidden");
  });

  $("#loginForm").submit(function(event) {
    event.preventDefault();
    var username = $("#username").val();
    var password = $("#password").val();

    // Perform the POST request for authentication
    $.ajax({
      url: "http://localhost:5000/auth",
      type: "POST",
      contentType: "application/json",
      data: JSON.stringify({ username: username, password: password }),
      success: function(response) {
        console.log("Response from server:", response);

        if ('token' in response) {
          alert("Authentication successful.\nToken: " + response.token);
          fetchInstallOptions(); // Fetch and display install options after authentication
        } else {
          alert("Authentication failed.");
        }
      },
      error: function(jqXHR, textStatus, errorThrown) {
        console.error("Request failed:", textStatus, "\n", errorThrown);
        alert("Request failed: " + textStatus + "\n" + errorThrown);
      }
    });
  });
});

function fetchInstallOptions() {
  $.get("http://localhost:5000/install1", function(data) {
    var files = data.files;
    displayOptions(files);
  });
}

function displayOptions(files) {
  var optionsList = document.getElementById("optionsList");

  optionsList.innerHTML = "";
  files.forEach(function(file) {
    var optionItem = document.createElement("li");
    optionItem.textContent = file;
    optionsList.appendChild(optionItem);

    // Add a click event listener to each list item
    optionItem.addEventListener("click", function() {
      submitSelectedFile(file);
    });
  });
}

function submitSelectedFile(selectedFile) {
  // Perform the POST request to /submit
  $.post("http://localhost:5000/submit", { file: selectedFile }, function(response) {
    console.log("Response from /submit:", response);
    alert("File submitted: " + selectedFile);
  });
}

</script>
</head>
<body>

<div class="spearmint-background">
  <h1>Currently Grabbing Installs</h1>

  <button class="gray-button" onclick="fetchInstallOptions()">Fetch Install Options</button>
  <ul id="optionsList"></ul>

  <button class="gray-button" id="showLoginForm">Login</button>

  <form id="loginForm" class="hidden">
    <label for="username">Username:</label>
    <input type="text" id="username" name="username"><br><br>

    <label for="password">Password:</label>
    <input type="password" id="password" name="password"><br><br>

    <input type="submit" value="Authenticate">
  </form>
</div>

</body>
</html>
